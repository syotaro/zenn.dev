---
title: "GoogleドライブのURL操作Tips"
emoji: "🕌"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [googledrive,google,gas]
published: true
---

- [1. よく使う](#1-よく使う)
    - [1.1. 読み取り専用モード](#11-読み取り専用モード)
    - [1.2. 実ファイル（pngやcsv）としてURL参照可能に](#12-実ファイルpngやcsvとしてurl参照可能に)
- [2. 稀に使う](#2-稀に使う)
    - [2.1. Webビューアーをスキップ（直接ダウンロードリンク）](#21-webビューアーをスキップ直接ダウンロードリンク)
    - [2.2. コピーして自分のものにする](#22-コピーして自分のものにする)
    - [2.3. テンプレート共有を目的としたプレビューモード](#23-テンプレート共有を目的としたプレビューモード)
    - [2.4. コピーするときにユーザーを招待する](#24-コピーするときにユーザーを招待する)
- [3. ほとんど使わない](#3-ほとんど使わない)
    - [3.1. プレゼンター表示モードに](#31-プレゼンター表示モードに)
    - [3.2. Webページに埋め込む](#32-webページに埋め込む)
    - [3.3. ユニバーサルファイルビューアー](#33-ユニバーサルファイルビューアー)
- [4. まとめ](#4-まとめ)

------

前提：Googleドライブ内のすべてのドキュメントは、開くとだいたい以下のようなURLで、編集状態になっている。

`https://docs.google.com/document/d/FILE_ID/edit`

URLを書き換えると、便利な挙動をさせることができる。

## 1. よく使う

### 1.1. 読み取り専用モード

- `https://docs.google.com/document/d/FILE_ID/`**edit**
    ↓
- `https://docs.google.com/document/d/FILE_ID/`**preview**
    へ変更する

### 1.2. 実ファイル（pngやcsv）としてURL参照可能に

以下のフォーマットで、ファイルとして、直接ダウンロードが可能
markdown等からも参照できて便利

- googleドキュメント
    - `https://docs.google.com/document/d/FILE_ID/`**export?format=pdf**
    - `https://docs.google.com/document/d/FILE_ID/`**export?format=doc**
- googleスライド
    - `https://docs.google.com/presentation/d/FILE_ID/`**export/pdf**
    - `https://docs.google.com/presentation/d/FILE_ID/`**export/pptx**
- googleシート
    - `https://docs.google.com/spreadsheets/d/FILE_ID/`**export?format=xlsx**
    - `https://docs.google.com/spreadsheets/d/FILE_ID/`**export?format=pdf**
    - `https://docs.google.com/spreadsheets/d/FILE_ID/`**export?format=csv**
- Google描画
    - `https://docs.google.com/drawings/d/FILE_ID/`**export/svg**
    - `https://docs.google.com/drawings/d/FILE_ID/`**export/pdf**
    - `https://docs.google.com/drawings/d/FILE_ID/`**export/jpg**

googleスライドは、ページ単位でも可能

- スライドのページをexport
    - `https://docs.google.com/presentation/d/FILE_ID/`**export/png?pageid=PAGE_ID**
    - `https://docs.google.com/presentation/d/FILE_ID/`**export/jpg?pageid=PAGE_ID**
    - `https://docs.google.com/presentation/d/FILE_ID/`**export/svg?pageid=PAGE_ID**

------

## 2. 稀に使う

### 2.1. Webビューアーをスキップ（直接ダウンロードリンク）

- 通常共有リンク
    - `https://drive.google.com/open?id=FILE_ID`
- 直接DL
    - `https://drive.google.com/uc?export=download&id=FILE_ID`
- Googleドライブのウェブビューアーでファイルを開く
    - `https://drive.google.com/file/d/FILE_ID/view`

### 2.2. コピーして自分のものにする

- Original Link:
    - `https://docs.google.com/document/d/FILE_ID/`**edit**
- Copy Link:
    - `https://docs.google.com/document/d/FILE_ID/`**copy**

パラメーターとして、以下が設定可能

- **?copyComments=true**
    - コピーしたドキュメントに元のドキュメントのコメントを含める場合
- **?includeResolvedCommentsOnCopy=false**
    - 解決されたコメントのコピーをスキップ
- **?copyCollaborators=false**
    - コピーされたドキュメントを元の共同編集者と共有しない

Googleフォームにも使用できるが、フォームの所有者がフォームへのアクセスを許可した場合にのみ、フォームは別のユーザーのGoogleアカウントにコピーされ流。

### 2.3. テンプレート共有を目的としたプレビューモード

`/copy`と似ているが、 `/template/preview`とすることで、テンプレートリンクになる（プレビューリンクとコピーの作成リンクの組み合わせ）
この時、**テンプレートを使用**ボタンも表示されます（このボタンをクリックすると、元のドキュメントのコピーが作成されます。そのコピーは、操作したユーザー所有になり、Googleドライブに配置されます）

このモードは、**コピーを作成**ボタンをクリックするのとは異なり、Googleドライブへコピーする前に、内容を見ることができます。
また、新しくコピーされたドキュメントのファイル名に「コピー」とつきません。

### 2.4. コピーするときにユーザーを招待する

ドキュメントをコピーしたGoogleユーザーは、ドキュメントをコピーした直後に特定のGoogleアカウントとドキュメントを共有するように求められます。

- `https://docs.google.com/document/d/FILE_ID/copy?userstoinvite=EMAIL_ADDRESS`

------

## 3. ほとんど使わない

### 3.1. プレゼンター表示モードに

- `https://docs.google.com/presentation/d/FILE_ID/`**present?slide=id.p21**
- `https://docs.google.com/presentation/d/FILE_ID/`**preview?rm=minimal**
- `https://docs.google.com/presentation/d/15CK...x4F8/`**preview?rm=full**

### 3.2. Webページに埋め込む

```html
<iframe src="https://docs.google.com/document/d/FILE_ID/preview" height="600px" width=“800px" allowfullscreen >
</iframe>
```

Googleのブランディングとプレーヤーコントロールを削除する場合、`rm=minimal`を、iframeリンクに追加します（rmとは、レンダリングモードのこと）

さらに、下記のように記載すれば、レスポンシブに表示させることもできます。

```html
<style>
    .responsive-google-slides {
        position: relative;
        padding-bottom: 56.25%;
        /* 16:9 Ratio */
        height: 0;
        overflow: hidden;
    }

    .responsive-google-slides iframe {
        border: 0;
        position: absolute;
        top: 0;
        left: 0;
        width: 100% !important;
        height: 100% !important;
    }
</style>

<div class="responsive-google-slides">

    <iframe
        src="https://docs.google.com/presentation/d/e/FILE_ID/embed?start=false&loop=false&delayms=3000&rm=minimal"></iframe>
</div>
```

### 3.3. ユニバーサルファイルビューアー

- `https://docs.google.com/viewer?url=https://file.pdf`

## 4. まとめ

googleが、これらURLによる挙動をあまりオープンにしていないが、便利なものばかりなので、覚えておくと得
